from pickle import load
import numpy as np
from sklearn import svm

# Load observations
with open('gen/observations-0001.p', 'rb') as file:
    x = load(file)
x = np.array(x)

# Split observations randomly in training and test set
training_size = int(len(x) * .9)
indices = np.random.permutation(len(x.shape))
training_idx, test_idx = indices[:training_size], indices[training_size:]
x_tr, x_te = x[training_idx, :], x[test_idx, :]
x_tr, x_te = x_tr[:, :-1], x_te[:, :-1]  # Last column is label column
y_tr, y_te = x_tr[:, -1], x_te[:, -1]

s = svm.SVC()
s.fit(x_tr, y_tr)
print(s)
